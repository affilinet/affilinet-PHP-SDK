<p>
    The SDK provides a Query Builder to easily generate complex SQL-like search requests.
</p>

<div class="well well-sm">
    The Query Builder should not be combined with the <a href="#products-facets">facet querystring generator</a>.

</div>


<p> Incldue terms </p>
{% highlight php  %}
<?php
$query = new \Affilinet\ProductData\Requests\Helper\Query();

$query->where(
        $query->expr()->containsAllOf('ipad', 'apple')
);

$productsRequest
    ->query($query)
    ->send();

{% endhighlight %}

<p>Alternativly you can chain expressions</p>
{% highlight php  %}
<?php
$query = new \Affilinet\ProductData\Requests\Helper\Query();
$query->where(
    $query->expr()
        ->contains('ipad')
        ->contains('apple')
);

$productsRequest
    ->query($query)
    ->send();

{% endhighlight %}



<p> Exactly match a term </p>
{% highlight php  %}
<?php
// will include apple but not applejuice
$query->where(
    $query
        ->expr()
        ->exactly('apple')
);
{% endhighlight %}



<p> Combine terms with OR </p>
{% highlight php  %}
<?php
// will include results matching apple or samsung
$query->where(
    $query
        ->expr()
        // you can add as many parameters as you like or an array
        ->containsOneOf('apple', 'samsung')
);
{% endhighlight %}



<p> Exclude terms </p>
{% highlight php  %}
<?php
$query->where(
    $query
        ->expr()
        // you can add as many parameters as you like or an array
        ->containsNot('ipad', 'apple')
);

{% endhighlight %}




<p>
    <strong>Examples</strong><br>
    Get all products containing "apple" but not containing "ipod", "iphone", "mac"
</p>

{% highlight php linenos %}
<?php
$productsRequest = new \Affilinet\ProductData\Requests\ProductsRequest($affilinet);
$query = new \Affilinet\ProductData\Requests\Helper\Query();
$query
    ->where(
        $query
            ->expr()
            ->contains('apple')
            // you can add as many parameters as you like or an array
            ->containsNot('ipod', 'iphone', 'mac', 'iPad' )
    );
$productsRequest->query( $query);

$response = $productsRequest->send();

{% endhighlight %}


<p>
    Get all products containing "apple"  and "ipad"
</p>
{% highlight php %}
<?php
$productsRequest = new \Affilinet\ProductData\Requests\ProductsRequest($affilinet);
$query = new \Affilinet\ProductData\Requests\Helper\Query();
$query
    ->where(
        $query
            ->expr()
            ->contains('apple')
            ->contains('ipad')
    );
$productsRequest->query( $query);

{% endhighlight %}





<p>
    <strong>Chain Query Expressions</strong> <br>
    Combine with OR: Find (apple and "iphone") or (samsung and "galaxy") </p>
{% highlight php  %}
<?php

$query
    ->where($query->epxr()
        ->contains('apple')
        ->exactly('iphone')
    )
    ->orWhere($query->expr()
        ->contains('samsung')
        ->exactly('galaxy')
    );

{% endhighlight %}



<p> Combine  OR with AND
<pre>
    ( "t-mobile")

    AND
    (
        (  apple AND "iphone" )
        OR
        (  samsung AND "galaxy" )

    )
</pre>
</p>

{% highlight php  %}
<?php
$productsRequest->query($query
    ->andWhere($query->expr()
        ->contains('apple')
        ->exactly('iphone')
        ->exactly('t-mobile')
    )
    ->orWhere($query->expr()
        ->contains('samsung')
        ->exactly('galaxy')
        ->exactly('t-mobile')
    )
);

{% endhighlight %}